---
name: xhs:publish
description: 发布小红书帖子 - 通过xhs_mcp发布到平台
argument-hint: --post <帖子目录路径> [--account <账号>] [--schedule <时间>]
allowed-tools:
  - Read
  - Write
  - Bash
  - AskUserQuestion
---

# 发布帖子命令

本命令将帖子发布到小红书平台。

## 使用方式

```bash
# 立即发布
/xhs:publish --post "文案生成/小红书自媒体帖子/账号/帖子目录"

# 指定账号发布
/xhs:publish --post "文案生成/..." --account "账号名"

# 定时发布（预留）
/xhs:publish --post "文案生成/..." --schedule "2025-01-15 20:00"
```

参数：
- `--post`：帖子目录路径或文件路径（必需）
- `--account`：发布账号名称（可选）
- `--schedule`：定时发布时间（可选，预留功能）

## 执行流程

### 第一步：加载帖子内容

1. 读取帖子目录或文件
2. 提取以下信息：
   - 标题
   - 正文内容
   - 标签
   - 配图（downloads/目录）

3. 验证内容完整性

### 第二步：内容预检查

#### 内容检查清单

- [ ] 标题长度（10-30字）
- [ ] 正文结构完整
- [ ] 标签数量合理（3-8个）
- [ ] 配图数量合理（3-7张）
- [ ] 图片格式正确（jpg/png）
- [ ] 文件大小合适

#### 合规性快速检查

- [ ] 无敏感词汇
- [ ] 无违规内容
- [ ] 符合平台规范

**注意**：如果发现问题，提示用户先使用 `/xhs:optimize-post` 优化

### 第三步：发布前确认

展示发布信息，请求用户确认：

```markdown
# 发布前确认

## 帖子信息
- 标题：[标题]
- 字数：[字数]
- 标签：[数量]个
- 配图：[数量]张

## 发布信息
- 目标账号：[账号名]
- 发布方式：立即发布
- 预计时间：[当前时间+2分钟]

## 内容预览

### 标题
[标题]

### 正文预览（前200字）
[正文前200字...]

### 配图
1. image_01.jpg (封面)
2. image_02.jpg
3. image_03.jpg

### 标签
[标签1] [标签2] [标签3] ...

---

⚠️ 重要提醒：
1. 发布后内容无法修改，只能删除
2. 请仔细检查内容是否有误
3. 确认配图顺序和内容

是否确认发布？(y/n)：
```

### 第四步：调用xhs_mcp发布

#### MCP服务调用

通过配置的MCP服务调用发布功能：

```json
{
  "mcpServers": {
    "xiaohongshu-automation": {
      "command": "uvx",
      "args": ["--from", "xiaohongshu-automation", "xhs-mcp"]
    }
  }
}
```

#### 发布参数

```python
# 调用MCP发布工具
mcp_call(
  server="xiaohongshu-automation",
  tool="publish_post",
  parameters={
    "title": "帖子标题",
    "content": "帖子正文",
    "tags": ["标签1", "标签2"],
    "images": [
      "path/to/image_01.jpg",
      "path/to/image_02.jpg"
    ],
    "account": "账号名"
  }
)
```

### 第五步：处理发布结果

#### 发布成功

```markdown
✅ 发布成功！

## 发布信息
- 帖子ID：[ID]
- 发布时间：[时间]
- 帖子链接：[链接]

## 后续建议
1. 观察24小时内数据表现
2. 及时回复用户评论
3. 分析数据优化后续内容

## 记录保存
发布信息已保存到：[帖子目录]/publish_info.json
```

#### 发布失败

```markdown
❌ 发布失败

## 错误信息
- 错误码：[错误码]
- 错误描述：[错误描述]

## 可能原因
1. [原因1]
2. [原因2]

## 解决建议
1. [建议1]
2. [建议2]

## 下一步
- 检查账号登录状态
- 检查网络连接
- 尝试重新发布
```

## 发布记录

### 记录文件格式

发布后自动记录发布信息到 `publish_info.json`：

```json
{
  "post_id": "帖子ID",
  "publish_time": "2025-01-14 20:30:00",
  "post_url": "帖子链接",
  "account": "发布账号",
  "title": "帖子标题",
  "content_stats": {
    "word_count": 800,
    "tag_count": 6,
    "image_count": 3
  },
  "publish_status": "success",
  "error": null
}
```

## 定时发布（预留功能）

当前为预留功能，未来支持：

```bash
/xhs:publish --post "路径" --schedule "2025-01-15 20:00"
```

定时发布功能需要：
- MCP服务支持定时任务
- 账号保持登录状态
- 充足的时间提前量

## 注意事项

### 发布前

1. **内容审核**
   - 仔细检查文字是否有错别字
   - 确认配图顺序和内容
   - 验证标签准确性

2. **时机选择**
   - 避开深夜时段（23:00-7:00）
   - 选择目标用户活跃时间
   - 避开重大事件时间

3. **账号状态**
   - 确认账号已登录
   - 检查账号正常状态
   - 确认有发布配额

### 发布后

1. **数据监控**
   - 观察 initial engagement
   - 记录关键数据指标
   - 分析用户反馈

2. **互动维护**
   - 及时回复评论
   - 感谢用户互动
   - 建立粉丝连接

3. **效果评估**
   - 24小时数据复盘
   - 总结成功要素
   - 优化后续内容

## 错误处理

### 认证失败

```
❌ 认证失败

请检查：
1. xhs_mcp服务是否正常启动
2. 账号是否已登录
3. 登录是否过期

解决方法：
重新登录账号后重试
```

### 内容违规

```
❌ 内容违规

系统检测到内容可能包含违规信息：
- [违规项1]
- [违规项2]

建议：
1. 修改相关内容
2. 使用 /xhs:optimize-post 审核
3. 重新提交发布
```

### 网络错误

```
❌ 网络错误

发布过程中遇到网络问题：
- 错误码：[错误码]
- 错误信息：[信息]

建议：
1. 检查网络连接
2. 稍后重试
3. 如问题持续，联系技术支持
```

### 图片上传失败

```
❌ 图片上传失败

部分图片上传失败：
- image_02.jpg：上传超时
- image_04.jpg：文件过大

建议：
1. 检查图片文件
2. 压缩图片大小
3. 重新上传
```

## 发布策略建议

### 最佳发布时间

| 时间段 | 适合内容 | 说明 |
|--------|---------|------|
| 7:00-9:00 | 职场、学习 | 早高峰，通勤时间 |
| 12:00-14:00 | 生活、美食 | 午休时间 |
| 18:00-20:00 | 娱乐、生活 | 晚高峰 |
| 20:00-22:00 | 全部内容 | 黄金时段 |

### 频率建议

- **日更**：适合成长期账号
- **周更3-4篇**：适合稳定期账号
- **质量优先**：宁缺毋滥

### 内容搭配

建议内容类型搭配：
- 60% 干货分享（建立专业度）
- 30% 生活记录（增加亲近感）
- 10% 互动内容（提升活跃度）

## MCP服务要求

xhs_mcp服务需要提供以下工具：

1. **publish_post**：发布帖子
   - 参数：title, content, tags, images, account
   - 返回：post_id, post_url

2. **check_account**：检查账号状态
   - 参数：account
   - 返回：login_status, quota_left

3. **schedule_post**：定时发布（预留）
   - 参数：post_data, schedule_time
   - 返回：schedule_id

## 发布后检查清单

- [ ] 帖子正常显示
- [ ] 配图全部加载
- [ ] 链接可访问
- [ ] 分享功能正常
- [ ] 开始记录数据

## 数据记录建议

发布后记录以下数据：

### 24小时内
- 浏览量
- 点赞数
- 收藏数
- 评论数
- 转发数
- 涨粉数

### 7天内
- 持续互动量
- 搜索展现量
- 粉丝增长率
- 转化效果（如有）

这些数据将帮助：
- 评估内容效果
- 优化创作方向
- 了解用户偏好
